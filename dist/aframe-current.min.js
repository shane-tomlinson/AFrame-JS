if(!Function.prototype.bind){Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a,arguments)}}}if(!Array.prototype.forEach){Array.prototype.forEach=function(e,c){var a=this.length;if(typeof e!="function"){throw new TypeError()}for(var b=0,d;d=this[b];++b){if(b in this){e.call(c,d,b,this)}}}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(b){var a=this.length>>>0;var c=Number(arguments[1])||0;c=c<0?Math.ceil(c):Math.floor(c);if(c<0){c+=a}for(;c<a;c++){if(c in this&&this[c]===b){return c}}return -1}}if(!Date.prototype.toISOString){Date.prototype.toISOString=function(){var a=function(c){return(c<10?"0":"")+c};var b=function(c){return(c<100?"0":"")+(c<10?"0":"")+c};return[this.getUTCFullYear(),"-",a(this.getUTCMonth()+1),"-",a(this.getUTCDate()),"T",a(this.getUTCHours()),":",a(this.getUTCMinutes()),":",a(this.getUTCSeconds()),".",b(this.getUTCMilliseconds()),"Z"].join("")}}if(!window.console){window.console=function(){}}var AFrame={extend:function(d,f){var e=function(){};e.prototype=f.prototype;d.prototype=new e();d.prototype.constuctor=d;d.superclass=f.prototype;var a=Array.prototype.slice.call(arguments,2);for(var b,c=0;b=a[c];++c){AFrame.mixin(d.prototype,b)}},mixin:function(b,a){b=jQuery.extend(b,a)},construct:function(h){var i=h.type;var b=h.config||{};var c=h.plugins||[];var a;if(i){try{a=new i()}catch(g){console.log(g.toString())}for(var f=0,d;d=c[f];++f){var j=AFrame.construct(d);j.setPlugged(a)}a.init(b)}else{throw"Class does not exist."}return a},remove:function(a,b){a[b]=null;delete a[b]},currentID:0,getUniqueID:function(){this.currentID++;return"cid"+this.currentID},defined:function(a){return"undefined"!=typeof(a)},func:function(a){return"function"==typeof(a)}};AFrame.Observable=function(){};AFrame.Observable.getInstance=function(){return AFrame.construct({type:AFrame.Observable})};AFrame.Observable.prototype={init:function(){this.callbacks={}},teardown:function(){this.unbindAll()},trigger:function(){this.triggered=true;for(var a in this.callbacks){var b=this.callbacks[a];b.apply(this,arguments)}},bind:function(b){var a=AFrame.getUniqueID();this.callbacks[a]=b;return a},unbind:function(a){AFrame.remove(this.callbacks,a)},unbindAll:function(){for(var a in this.callbacks){AFrame.remove(this.callbacks,a)}},isTriggered:function(){return !!this.triggered}};AFrame.ObservablesMixin={triggerEvent:function(){var a=arguments[0];var c=this.events&&this.events[a];if(c){var b=Array.prototype.slice.call(arguments,1);c.trigger.apply(c,b)}},isEventTriggered:function(b){var a=false;var c=this.events&&this.events[b];if(c){a=c.isTriggered()}return a},bindEvent:function(b,e,c){this.events=this.events||{};var d=this.events[b]||AFrame.Observable.getInstance();this.events[b]=d;var a=d.bind(e.bind(c||this));this.bindings=this.bindings||{};this.bindings[a]={object:c,observable:d};if(c&&c.bindTo){c.bindTo(this,a)}return a},unbindEvent:function(b){var a=this.bindings&&this.bindings[b];if(a){AFrame.remove(this.bindings,b);if(a.object&&a.object.unbindTo){a.object.unbindTo(b)}return a.observable.unbind(b)}},unbindAll:function(){for(var a in this.events){this.events[a].unbindAll();AFrame.remove(this.events,a)}for(var c in this.bindings){var b=this.bindings[c];AFrame.remove(this.bindings,c);if(b.object&&b.object.unbindTo){b.object.unbindTo(c)}}},proxyEvents:function(b,a){a.forEach(function(c,d){b.bindEvent(c,function(){var e=Array.prototype.slice.call(arguments,0);e.splice(0,0,c);this.triggerEvent.apply(this,e)}.bind(this),this)},this)},bindTo:function(a,b){this.boundTo=this.boundTo||{};this.boundTo[b]=this.boundTo[b]||{object:a}},unbindTo:function(b){var a=this.boundTo[b];if(a){a.object.unbindEvent(b);AFrame.remove(this.boundTo,b)}},unbindToAll:function(){for(var b in this.boundTo){var a=this.boundTo[b];a.object.unbindEvent(b);AFrame.remove(this.boundTo,b)}this.boundTo=null;this.boundTo={}}};AFrame.AObject=function(){};AFrame.mixin(AFrame.AObject.prototype,{constructor:AFrame.AObject,init:function(a){this.config=a;this.cid=a.cid||AFrame.getUniqueID();this.children={};this.bindEvents();this.triggerEvent("onInit",this)},getConfig:function(){return this.config},bindEvents:function(){},teardown:function(){this.triggerEvent("onTeardown",this);this.unbindAll();this.unbindToAll();this.teardownChildren();this.config=this.cid=this.children=null},teardownChildren:function(){for(var b in this.children){var a=this.children[b];a.teardown();AFrame.remove(this.children,b)}},getCID:function(){return this.cid},addChild:function(a){this.children[a.getCID()]=a},removeChild:function(a){AFrame.remove(this.children,a)}});AFrame.mixin(AFrame.AObject.prototype,AFrame.ObservablesMixin);AFrame.DataContainer=function(a){if(a instanceof AFrame.DataContainer){return a}else{if(a){var b=a.__dataContainer;if(!b){b=AFrame.construct({type:AFrame.DataContainer,config:{data:a}})}return b}}AFrame.DataContainer.superclass.constructor.apply(this,arguments)};AFrame.extend(AFrame.DataContainer,AFrame.AObject,{init:function(a){this.data=a.data||{};this.data.__dataContainer=this;this.fieldBindings={};AFrame.DataContainer.superclass.init.apply(this,arguments)},set:function(d,c){var a=this.data[d];this.data[d]=c;var b=this.getFieldNotificationObject(d,c,a);this.triggerEvent("onSet",b);this.triggerEvent("onSet-"+d,b);return a},get:function(a){return this.data[a]},bindField:function(d,c,b){var a=this.getFieldNotificationObject(d,this.get(d),undefined);c.call(b,a);return this.bindEvent("onSet-"+d,c,b)},unbindField:function(a){return this.unbindEvent(a)},getFieldNotificationObject:function(c,b,a){return{container:this,fieldName:c,oldValue:a,value:b}},forEach:function(c,b){for(var a in this.data){if(a!=="__dataContainer"){c.call(b,this.data[a],a)}}}});AFrame.Plugin=function(){AFrame.Plugin.superclass.constructor.apply(this,arguments)};AFrame.extend(AFrame.Plugin,AFrame.AObject,{setPlugged:function(a){this.plugged=a;this.plugged.bindEvent("onTeardown",this.teardown,this)},getPlugged:function(){return this.plugged},teardown:function(){AFrame.remove(this,"plugged");AFrame.Plugin.superclass.teardown.apply(this,arguments)}});AFrame.ArrayCommonFuncsMixin={getCount:function(){throw"operation not supported"},getActualInsertIndex:function(b){var a=this.getCount();if("undefined"==typeof(b)){b=a}else{if(b<0){b=a+(b+1)}}b=Math.max(0,b);b=Math.min(a,b);return b},getActualIndex:function(b){var a=this.getCount();if(b<0){b=a+b}b=Math.min(a-1,b);b=Math.max(0,b);return b}};AFrame.CollectionHash=function(){AFrame.CollectionHash.superclass.constructor.apply(this,arguments)};AFrame.CollectionHash.currID=0;AFrame.extend(AFrame.CollectionHash,AFrame.AObject,{init:function(a){this.hash={};AFrame.CollectionHash.superclass.init.apply(this,arguments)},teardown:function(){for(var a in this.hash){AFrame.remove(this.hash,a)}AFrame.remove(this,"hash");AFrame.CollectionHash.superclass.teardown.apply(this,arguments)},get:function(a){return this.hash[a]},remove:function(c){var a=this.get(c);if(a){var b=this.getEventData(a,{cid:c});this.triggerEvent("onBeforeRemove",b);AFrame.remove(this.hash,c);this.triggerEvent("onRemove",b)}return a},insert:function(a){var c=a.cid||AFrame.getUniqueID();if("undefined"!=typeof(this.get(c))){throw"duplicate cid"}if(a instanceof Object){a.cid=c}var b=this.getEventData(a,{cid:c});this.triggerEvent("onBeforeInsert",b);this.hash[c]=a;this.triggerEvent("onInsert",b);return c},clear:function(){for(var a in this.hash){this.remove(a)}},getCount:function(){var a=0;for(var b in this.hash){a++}return a},getEventData:function(a,b){b=b||{};b=jQuery.extend(b,{collection:this,item:a});return b}});AFrame.CollectionArray=function(){AFrame.CollectionArray.superclass.constructor.apply(this,arguments)};AFrame.extend(AFrame.CollectionArray,AFrame.CollectionHash,AFrame.ArrayCommonFuncsMixin,{init:function(){this.itemCIDs=[];AFrame.CollectionArray.superclass.init.apply(this,arguments)},teardown:function(){this.itemCIDs.forEach(function(b,a){this.itemCIDs[a]=null},this);AFrame.remove(this,"itemCIDs");AFrame.CollectionArray.superclass.teardown.apply(this,arguments)},insert:function(b,a){a="number"==typeof(a)?a:-1;this.currentIndex=this.getActualInsertIndex(a);var c=AFrame.CollectionArray.superclass.insert.call(this,b);this.itemCIDs.splice(this.currentIndex,0,c);return c},get:function(b){var c=this.getCID(b);var a;if(c){a=AFrame.CollectionArray.superclass.get.call(this,c)}return a},remove:function(b){var c;if("string"==typeof(b)){c=b;b=this.getIndex(b)}else{b=this.getActualIndex(b);c=this.getCID(b)}var a;if(b>-1){this.itemCIDs.splice(b,1);this.currentIndex=b;a=AFrame.CollectionArray.superclass.remove.call(this,c)}return a},clear:function(){AFrame.CollectionArray.superclass.clear.call(this);this.itemCIDs=[]},getCount:function(){return this.itemCIDs.length},getArray:function(){var a=[];this.itemCIDs.forEach(function(c,b){a[b]=this.hash.get(c)});return a},getEventData:function(a,b){b=b||{};b=jQuery.extend(b,{index:this.currentIndex});return AFrame.CollectionArray.superclass.getEventData.call(this,a,b)},getCID:function(a){var b=a;if("number"==typeof(a)){a=this.getActualIndex(a);b=this.itemCIDs[a]}return b},getIndex:function(a){if("string"==typeof(a)){a=this.itemCIDs.indexOf(a)}return a}});AFrame.Display=function(){AFrame.Display.superclass.constructor.apply(this,arguments)};AFrame.Display.currDOMEventID=0;AFrame.extend(AFrame.Display,AFrame.AObject,{init:function(a){this.target=$(a.target);if(!this.target.length){throw"invalid target"}this.render();this.domEvents={};AFrame.Display.superclass.init.apply(this,arguments)},teardown:function(){for(var a in this.domEvents){this.unbindDOMEvent(a)}},render:function(){this.triggerEvent("onRender",this)},getTarget:function(){return this.target},getDOMElement:function(){return this.getTarget()[0]},bindDOMEvent:function(e,a,g,b){var c=g.bind(b||this);var d=this.getEventTarget(e);d.bind(a,c);AFrame.Display.currDOMEventID++;var f=AFrame.Display.currDOMEventID;this.domEvents[f]={target:d,eventName:a,callback:c};return f},bindClick:function(b,c,a){return this.bindDOMEvent(b,"click",function(d){d.preventDefault();c.call(a,d)},a)},unbindDOMEvent:function(b){var a=this.domEvents[b];if(a){a.target.unbind(a.eventName,a.callback);a.target=null;a.eventName=null;a.callback=null;AFrame.remove(this.domEvents,b)}},getEventTarget:function(b){var a;if("string"==typeof(b)){a=$(b,this.getTarget())}else{a=$(b)}return a}});AFrame.List=function(){AFrame.List.superclass.constructor.apply(this,arguments)};AFrame.extend(AFrame.List,AFrame.Display,AFrame.ArrayCommonFuncsMixin,{init:function(a){if(a.listElementFactory){this.listElementFactory=a.listElementFactory}AFrame.List.superclass.init.apply(this,arguments)},clear:function(){this.getTarget().html("")},listElementFactory:function(){return $("<li />")},insert:function(c,a){a=this.getActualInsertIndex(a);var b=this.listElementFactory(c,a);a=this.insertElement(b,a);this.triggerEvent("onInsert",{rowElement:b,data:c,index:a});return a},insertElement:function(d,b){var e=this.getTarget();var c=e.children();b=this.getActualInsertIndex(b);if(b===c.length){e.append(d)}else{var a=c.eq(b);d.insertBefore(a)}this.triggerEvent("onInsertElement",{rowElement:d,index:b});return b},remove:function(a){var b=this.getActualIndex(a);var c=this.getTarget().children().eq(b).remove();this.triggerEvent("onRemoveElement",{rowElement:c,index:a})},getCount:function(){return this.getTarget().children().length}});AFrame.ListPluginBindToCollection=function(){AFrame.ListPluginBindToCollection.superclass.constructor.apply(this,arguments)};AFrame.extend(AFrame.ListPluginBindToCollection,AFrame.Plugin,{init:function(a){this.collection=a.collection;this.collection.bindEvent("onInsert",this.onInsert,this);this.collection.bindEvent("onRemove",this.onRemove,this);this.cids=[];AFrame.ListPluginBindToCollection.superclass.init.apply(this,arguments)},setPlugged:function(a){a.getIndex=this.getIndex.bind(this);AFrame.ListPluginBindToCollection.superclass.setPlugged.apply(this,arguments)},onInsert:function(b){var a=this.getPlugged().insert(b.item,b.index||-1);this.cids.splice(a,0,b.cid)},onRemove:function(b){var a=this.cids.indexOf(b.cid);this.getPlugged().remove(a);this.cids.splice(a,1)},getIndex:function(b){var a=b;if("string"==typeof(b)){a=this.cids.indexOf(b)}return a}});AFrame.CollectionPluginPersistence=function(){AFrame.CollectionPluginPersistence.superclass.constructor.apply(this,arguments)};AFrame.extend(AFrame.CollectionPluginPersistence,AFrame.Plugin,{init:function(a){this.addCallback=a.addCallback||this.noPersistenceOp;this.saveCallback=a.saveCallback||this.noPersistenceOp;this.loadCallback=a.loadCallback||this.noPersistenceOp;this.deleteCallback=a.deleteCallback||this.noPersistenceOp;AFrame.CollectionPluginPersistence.superclass.init.apply(this,arguments)},noPersistenceOp:function(b,a){var c=a.onComplete;c&&c(b,a)},setPlugged:function(a){a.add=this.add.bind(this);a.load=this.load.bind(this);a.del=this.del.bind(this);a.save=this.save.bind(this);AFrame.CollectionPluginPersistence.superclass.setPlugged.apply(this,arguments)},add:function(b,a){a=this.getOptions(a);var c=a.onComplete;a.onComplete=function(){var d=this.getPlugged().insert(b,a.insertAt);a.cid=d;a.onComplete=c;c&&c(b,a)}.bind(this);this.addCallback(b,a)},load:function(a){a=this.getOptions(a);var b=a.onComplete;a.onComplete=function(c){if(c){var d=this.getPlugged();c.forEach(function(f,e){d.insert(f)})}a.onComplete=b;b&&b(c,a)}.bind(this);this.loadCallback(a)},del:function(d,a){var b=this.getPlugged();var c=b.get(d);if(c){a=this.getOptions(a);var e=a.onComplete;a.onComplete=function(){b.remove(d,a);a.onComplete=e;e&&e(c,a)}.bind(this);this.deleteCallback(c,a)}},save:function(c,a){var b=this.getPlugged().get(c);if(b){a=this.getOptions(a);var d=a.onComplete;a.onComplete=function(){a.onComplete=d;d&&d(b,a)}.bind(this);this.saveCallback(b,a)}},getOptions:function(a){a=a||{};a.collection=this.getPlugged();return a}});AFrame.Form=function(){AFrame.Form.superclass.constructor.apply(this,arguments)};AFrame.extend(AFrame.Form,AFrame.Display,{init:function(a){this.formFieldFactory=a.formFieldFactory||this.formFieldFactory;this.formElements=[];this.formFields=[];AFrame.Form.superclass.init.apply(this,arguments);this.bindFormElements()},formFieldFactory:function(a){return AFrame.construct({type:AFrame.Field,config:{target:a}})},bindFormElements:function(){var a=$("[data-field]",this.getTarget());a.each(function(b,c){this.bindFormElement(c)}.bind(this))},teardown:function(){this.formFields&&this.formFields.forEach(function(b,a){b.teardown();this.formFields[a]=null},this);this.formFields=null;this.formElements=null;AFrame.Form.superclass.teardown.apply(this,arguments)},bindFormElement:function(a){var c=$(a);this.formElements.push(c);var b=this.formFieldFactory(c);this.formFields.push(b);return b},getFormElements:function(){return this.formElements},getFormFields:function(){return this.formFields},checkValidity:function(){var b=true;for(var a=0,c;(c=this.formFields[a])&&b;++a){b=c.checkValidity()}return b},clear:function(){this.fieldAction("clear")},reset:function(){this.fieldAction("reset")},save:function(){var a=this.checkValidity();if(a){this.fieldAction("save")}return a},fieldAction:function(a){this.formFields.forEach(function(c,b){c[a]()})}});AFrame.Field=function(){AFrame.Field.superclass.constructor.apply(this,arguments)};AFrame.Field.cancelInvalid=false;AFrame.extend(AFrame.Field,AFrame.Display,{init:function(a){AFrame.Field.superclass.init.apply(this,arguments);this.resetVal=this.getDisplayed();this.display(this.getPlaceholder());this.html5Validate=!!this.getTarget()[0].checkValidity},bindEvents:function(){var a=this.getTarget();this.bindDOMEvent(a,"keyup",this.onFieldChange,this);this.bindDOMEvent(a,"focus",this.onFieldFocus,this);this.bindDOMEvent(a,"blur",this.onFieldBlur,this);this.bindDOMEvent(a,"invalid",this.onFieldInvalid,this);AFrame.Field.superclass.bindEvents.apply(this,arguments)},getPlaceholder:function(){var a=this.getTarget();return a.attr("placeholder")||""},set:function(a){this.resetVal=a;a=a||this.getPlaceholder();this.display(a)},display:function(c){var b=this.getTarget();var a=c==this.getPlaceholder()?"addClass":"removeClass";b[a]("empty");if(this.isValBased(b)){b.val(c)}else{b.html(c)}},getDisplayed:function(){var b=this.getTarget();var a="";if(this.isValBased(b)){a=b.val()}else{a=b.html()}return a},reset:function(){this.set(this.resetVal)},checkValidity:function(){this.validityState=AFrame.FieldValidityState.getInstance(this.getTarget()[0].validity);var a=this.validate();this.validityStateIsCurrent=true;return a},validate:function(){var a=true;if(this.html5Validate){a=this.getTarget()[0].checkValidity()}else{var b=this.getTarget().hasAttr("required");a=(!b||!!this.get().length);if(!a){this.setError("valueMissing")}}return a},getValidityState:function(){if(!this.validityStateIsCurrent){this.checkValidity()}return this.validityState},setError:function(a){this.validityState.setError(a)},setCustomValidity:function(a){this.validityState.setCustomValidity(a)},clear:function(){this.set("")},get:function(){return this.resetVal},save:function(){var a=this.getDisplayed();if(a==this.getPlaceholder()){a=""}this.resetVal=a},onFieldChange:function(a){this.triggerEvent("onChange",this.get());this.validityStateIsCurrent=false},onFieldFocus:function(){if(this.getDisplayed()==this.getPlaceholder()){this.display("")}},onFieldBlur:function(){if(""===this.getDisplayed()){this.display(this.getPlaceholder())}},onFieldInvalid:function(a){if(AFrame.Field.cancelInvalid){a.preventDefault()}},isValBased:function(a){return a.is("input")||a.is("textarea")}});$.fn.hasAttr=function(a){return typeof(this.attr(a))!="undefined"};AFrame.FieldValidityState=function(a){if(a){AFrame.mixin(this,a)}};AFrame.FieldValidityState.getInstance=function(a){return new AFrame.FieldValidityState(a||{})};AFrame.FieldValidityState.prototype={valueMissing:false,typeMismatch:false,patternMismatch:false,tooLong:false,rangeUnderflow:false,rangeOverflow:false,stepMismatch:false,customError:false,valid:true,validationMessage:"",setError:function(a){this[a]=true;this.valid=false},setCustomValidity:function(a){if(a){this.valid=false;this.customError=true;this.validationMessage=a}}};AFrame.Schema=function(){};AFrame.Schema.prototype={init:function(a){this.schema=a.schema},getDefaults:function(){var a={};for(var b in this.schema){a[b]=this.getDefaultValue(b)}return a},getDefaultValue:function(a){var b=this.schema[a].def;if(AFrame.func(b)){b=b()}else{if(this.schema[a].has_many){b=[]}else{if(AFrame.Schema.getSchema(this.schema[a].type)){b={}}}}return b},getAppData:function(a){var b={};this.forEach(function(d,c){var e=a[c];if(!AFrame.defined(e)){e=this.getDefaultValue(c)}if(d.has_many){e&&e.forEach&&e.forEach(function(g,f){e[f]=this.getAppDataValue(g,d,a,b)},this)}else{e=this.getAppDataValue(e,d,a,b)}b[c]=e},this);return b},getAppDataValue:function(d,c,f,g){var b=AFrame.Schema.getSchema(c.type);if(b){d=b.getAppData(d)}else{if(AFrame.defined(d)){var e=AFrame.Schema.deserializers[c.type];if(AFrame.func(e)){d=e(d)}}}var a=c.fixup;if(AFrame.func(a)){d=a({value:d,data:f,fixed:g})}return d},serializeItems:function(b){var a={};this.forEach(function(d,c){if(d.save!==false){var e=b[c];if(d.has_many){e&&e.forEach&&e.forEach(function(g,f){e[f]=this.getSerializedValue(g,d,b,a)},this)}else{e=this.getSerializedValue(e,d,b,a)}a[c]=e}},this);return a},getSerializedValue:function(f,e,d,b){var a=e.cleanup;if(AFrame.defined(a)){f=a({value:f,data:d,cleaned:b})}if(AFrame.defined(f)){var c=AFrame.Schema.getSchema(e.type);if(c){f=c.serializeItems(f)}else{var g=AFrame.Schema.serializers[e.type];if(AFrame.func(g)){f=g(f)}}}return f},forEach:function(d,b){for(var a in this.schema){var c=this.schema[a];d.call(b,c,a)}}};AFrame.mixin(AFrame.Schema,{deserializers:{},serializers:{},schemaConfigs:{},schemaCache:{},addDeserializer:function(a,b){AFrame.Schema.deserializers[a]=b},addSerializer:function(a,b){AFrame.Schema.serializers[a]=b},addSchemaConfig:function(b,a){AFrame.Schema.schemaConfigs[b]=a},getSchema:function(a){if(!AFrame.Schema.schemaCache[a]&&AFrame.Schema.schemaConfigs[a]){AFrame.Schema.schemaCache[a]=AFrame.construct({type:AFrame.Schema,config:{schema:AFrame.Schema.schemaConfigs[a]}})}return AFrame.Schema.schemaCache[a]}});AFrame.Schema.addDeserializer("number",function(a){return parseFloat(a)});AFrame.Schema.addDeserializer("integer",function(a){return parseInt(a,10)});AFrame.Schema.addDeserializer("iso8601",function(g){try{var c=g.split("T"),i=c[0].split("-"),h=c[1].split("Z"),d=h[0].split(":"),a=d[2].split("."),b=Number(d[0]),j=new Date;j.setUTCFullYear(Number(i[0]));j.setUTCMonth(Number(i[1])-1);j.setUTCDate(Number(i[2]));j.setUTCHours(Number(b));j.setUTCMinutes(Number(d[1]));j.setUTCSeconds(Number(a[0]));if(a[1]){j.setUTCMilliseconds(Number(a[1]))}return j}catch(f){}});AFrame.Schema.addSerializer("iso8601",function(a){return a.toISOString()});AFrame.ListPluginFormRow=function(){AFrame.ListPluginFormRow.superclass.constructor.apply(this,arguments)};AFrame.extend(AFrame.ListPluginFormRow,AFrame.Plugin,{init:function(a){this.formFactory=a.formFactory||this.formFactory;this.forms=[];AFrame.ListPluginFormRow.superclass.init.apply(this,arguments)},setPlugged:function(a){a.bindEvent("onInsert",this.onInsertRow,this);a.bindEvent("onRemove",this.onRemoveRow,this);a.validate=this.validate.bind(this);a.save=this.save.bind(this);a.reset=this.reset.bind(this);a.clear=this.clear.bind(this);a.getForm=this.getForm.bind(this);AFrame.ListPluginFormRow.superclass.setPlugged.apply(this,arguments)},teardown:function(){this.forms.forEach(function(b,a){b.teardown();this.forms[a]=null},this);AFrame.ListPluginFormRow.superclass.teardown.apply(this,arguments)},formFactory:function(b,c){var a=AFrame.construct({type:AFrame.DataForm,config:{target:b,dataSource:c}});return a},onInsertRow:function(c,a){var b=this.formFactory(c.rowElement,c);this.forms.splice(a,0,b)},onRemoveRow:function(c,a){var b=this.forms[a];b.teardown();this.forms[a]=null;this.forms.splice(a,1)},validate:function(a){var c=true;var b;if(AFrame.defined(a)){b=this.forms[a];if(b){c=b.validate()}}else{for(a=0;c&&(b=this.forms[a]);++a){c=b.validate()}}return c},save:function(a){this.formFunc(a,"save")},reset:function(a){this.formFunc(a,"reset")},clear:function(a){this.formFunc(a,"clear")},formFunc:function(a,c){if(AFrame.defined(a)){var b=this.forms[a];if(b){b[c]()}}else{this.forms.forEach(function(e,d){e[c]()})}},getForm:function(a){return this.forms[a]}});AFrame.DataForm=function(){AFrame.DataForm.superclass.constructor.apply(this,arguments)};AFrame.extend(AFrame.DataForm,AFrame.Form,{init:function(a){this.dataContainer=AFrame.DataContainer(a.dataSource);AFrame.DataForm.superclass.init.apply(this,arguments)},teardown:function(){this.dataContainer=null;AFrame.DataForm.superclass.teardown.apply(this,arguments)},bindFormElement:function(a){var b=AFrame.DataForm.superclass.bindFormElement.apply(this,arguments);var c=$(a).attr("data-field");this.dataContainer.bindField(c,function(d){this.set(d.value)}.bind(b),this);return b},save:function(){var b=AFrame.DataForm.superclass.save.apply(this,arguments);if(b){var a=this.getFormFields();a.forEach(function(d,c){var e=d.getTarget().attr("data-field");this.dataContainer.set(e,d.get())},this)}return b}});